---
image:
  repository: "teaglebuilt/multigres"
  tag: "test"
  pullPolicy: Always
  pullSecrets: []

config:
  enabled: true
  file: |-
    logging:
      level: info
    topology:
      clusters: []

postgres:
  host: "postgres.default.svc.cluster.local"
  port: 5432
  database: "appdb"
  user: "appuser"
  passwordSecretName: "multigres-postgres-credentials"
  passwordSecretKey: "password"
  password: ""

topology:
  implementation: etcd2
  globalRoot: /multigres/global
  # Cell name for this deployment (optional, used for multi-cell deployments)
  cell: ""
  # If etcd.enabled is true, this is auto-configured to use the deployed etcd
  # Otherwise, specify your external etcd address(es) here
  serverAddresses: ""

gateway:
  enabled: true
  replicas: 1
  extraArgs: []
  extraEnv: []
  resources: {}

  livenessProbe:
    enabled: true
    initialDelaySeconds: 10
    periodSeconds: 10
    timeoutSeconds: 5
    failureThreshold: 3

  readinessProbe:
    enabled: true
    initialDelaySeconds: 5
    periodSeconds: 5
    timeoutSeconds: 3
    failureThreshold: 3

  service:
    type: ClusterIP
    port: 5432
    annotations: {}
    labels: {}

pooler:
  enabled: true
  replicas: 1
  tableGroup: "default"  # Table group this pooler serves (required)
  extraArgs: []
  extraEnv: []
  resources: {}

  livenessProbe:
    enabled: true
    initialDelaySeconds: 10
    periodSeconds: 10
    timeoutSeconds: 5
    failureThreshold: 3

  readinessProbe:
    enabled: true
    initialDelaySeconds: 5
    periodSeconds: 5
    timeoutSeconds: 3
    failureThreshold: 3

  service:
    type: ClusterIP
    port: 6432
    annotations: {}
    labels: {}

etcd:
  enabled: true
  replicas: 1
  image:
    repository: quay.io/coreos/etcd
    tag: v3.5.17
    pullPolicy: IfNotPresent
  clientPort: 2379
  peerPort: 2380
  extraArgs: []
  extraEnv: []
  resources:
    requests:
      cpu: "100m"
      memory: "256Mi"
    limits:
      cpu: "500m"
      memory: "512Mi"

  persistence:
    enabled: true
    storageClass: ""
    accessMode: ReadWriteOnce
    size: 2Gi

  livenessProbe:
    enabled: true
    initialDelaySeconds: 10
    periodSeconds: 10
    timeoutSeconds: 5
    failureThreshold: 3

  readinessProbe:
    enabled: true
    initialDelaySeconds: 5
    periodSeconds: 5
    timeoutSeconds: 3
    failureThreshold: 3

  service:
    type: ClusterIP
    port: 2379
    annotations: {}

serviceAccount:
  create: true
  automount: true
  annotations: {}
  name: ""

podAnnotations: {}
podLabels: {}
nodeSelector: {}
tolerations: []
affinity: {}

resources:
  requests:
    cpu: "100m"
    memory: "256Mi"
  limits:
    cpu: "1"
    memory: "1Gi"

pdb:
  enabled: true
  minAvailable: 1

autoscaling:
  enabled: false
  gateway:
    minReplicas: 2
    maxReplicas: 10
    targetCPUUtilizationPercentage: 80
  pooler:
    minReplicas: 2
    maxReplicas: 10
    targetCPUUtilizationPercentage: 80

# CloudNative-PG operator (deploys and manages PostgreSQL)
cloudnative-pg:
  enabled: true

# PostgreSQL Cluster configuration (requires cloudnative-pg.enabled: true)
cluster:
  enabled: true
  name: "multigres-pg"
  instances: 1
  storage:
    size: 5Gi
    storageClass: ""
  postgresql:
    parameters: {}
  bootstrap:
    initdb:
      database: "appdb"
      owner: "appuser"
